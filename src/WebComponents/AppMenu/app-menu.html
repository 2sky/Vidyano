<link rel="import" href="../Button/button.html" />
<link rel="import" href="../InputSearch/input-search.html" />
<link rel="import" href="../Scroller/scroller.html" />

<dom-module id="vi-app-menu">
    <template>
        <link rel="stylesheet" href="app-menu.css" />
        <div class="content flex layout vertical">
            <header>
                <div class="label flex">
                    <h1>[[label]]</h1>
                    <content select="[label]"></content>
                </div>
            </header>
            <vi-scroller class="flex programUnits" no-horizontal>
                <template is="dom-repeat" items="[[programUnits]]" as="programUnit">
                    <vi-app-menu-item class="program-unit" item="[[programUnit]]" filter="[[filter]]" program-unit="[[activeProgramUnit]]" collapsed="[[collapsed]]" items="[[programUnit.items]]" collapse-groups-on-tap></vi-app-menu-item>
                    <template is="dom-if" if="[[_computeIsFirstRunProgramUnit(app.service.application, programUnit)]]">
                        <div id="add" on-tap="_add">+ Add menu item</div>
                    </template>
                </template>
            </vi-scroller>
            <button is="vi-button" class="layout horizontal-reverse" id="toggleCollapse" on-tap="_toggleCollapse" inverse>
                <vi-icon source="Hamburger"></vi-icon>
            </button>
            <div id="resizer" on-track="_onResize"></div>
        </div>
        <div id="collapsed"></div>
    </template>
</dom-module>

<dom-module id="vi-app-menu-item">
    <template>
        <link rel="stylesheet" href="app-menu-item.css" />
        <a class="title" href$="[[href]]" target$="_blank" rel$="[[rel]]">
            <vi-icon source="[[icon]]"></vi-icon>
            <span class="flex" id="title" on-mouseenter="_titleMouseenter"></span>
        </a>
        <iron-collapse id="subItems" class="subItems" hidden$="[[!hasItems]]" no-animation>
            <template is="dom-repeat" items="[[items]]" as="subItem">
                <vi-app-menu-item item="[[subItem]]" items="[[subItem.items]]" level="[[subLevel]]" filter="[[filter]]" filter-parent="[[item]]"></vi-app-menu-item>
            </template>
        </iron-collapse>
    </template>
</dom-module>

<script src="app-menu.js"></script>