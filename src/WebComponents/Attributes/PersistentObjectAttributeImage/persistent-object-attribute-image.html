<link rel="import" href="../../Button/button.html" />
<link rel="import" href="../../Dialog/dialog.html" />

<dom-module id="vi-persistent-object-attribute-image">
    <template>
        <link rel="stylesheet" href="persistent-object-attribute-image.css" />
        <dom-if if="[[!editing]]" restamp>
            <template>
                <div class="fit">
                    <img src="[[image]]" on-tap="_showDialog" can-open$="[[canOpen]]" sensitive$="[[sensitive]]" />
                </div>
            </template>
        </dom-if>
        <dom-if if="[[editing]]" restamp>
            <template>
                <vi-persistent-object-attribute-edit attribute="[[attribute]]">
                    <div class="flex relative">
                        <div class="fit image-container">
                            <img src="[[image]]" on-tap="_showDialog" can-open$="[[canOpen]]" sensitive$="[[sensitive]]" />
                        </div>
                    </div>
                    <dom-if if="[[!readOnly]]">
                        <template>
                            <button slot="button" class="browse">
                                <vi-icon source="ImageUpload"></vi-icon>
                                <input type="file" accept="image/*" capture="environment" on-change="_change">
                            </button>
                            <dom-if if="[[hasValue]]" restamp>
                                <template>
                                    <button slot="button" on-tap="_clear" tabindex="-1">
                                        <vi-icon source="Remove"></vi-icon>
                                    </button>
                                </template>
                            </dom-if>
                        </template>
                    </dom-if>
                </vi-persistent-object-attribute-edit>
            </template>
        </dom-if>
    </template>
</dom-module>

<dom-module id="vi-persistent-object-attribute-image-dialog">
    <template>
        <link rel="stylesheet" href="persistent-object-attribute-image-dialog.css" />
        <header class="relative">
            <vi-size-tracker size="{{headerSize}}"></vi-size-tracker>
            <h4 class="flex">[[label]]</h4>
        </header>
        <main class="layout horizontal center">
            <vi-spinner id="spinner"></vi-spinner>
            <button is="vi-button" class="previous" icon="ChevronLeft" inverse hidden$="[[!hasMultiple]]" on-tap="_previous"></button>
            <img id="img" hidden src$="[[source]]" />
            <button is="vi-button" class="next" icon="ChevronRight" inverse hidden$="[[!hasMultiple]]" on-tap="_next"></button>
        </main>
        <footer class="horizontal layout end-justified relative">
            <vi-size-tracker size="{{footerSize}}"></vi-size-tracker>
            <vi-button on-tap="_close" action-type="Default" label="[[translateMessage('Close', isConnected)]]"></vi-button>
        </footer>
    </template>
</dom-module>

<!-- Image by Endrian Kolopaking from the Noun Project-->
<vi-resource type="icon" name="ImageUpload">
    <svg viewBox="0 0 32 32">
        <g>
            <path d="m 19.614079,3.2046995 0,5.909369 c -1.97001,8.3e-4 -3.940507,7.33e-4 -5.910932,0.0016 4.14e-4,1.0920095 4.14e-4,2.1829885 0,3.2749965 1.970425,8.31e-4 3.940922,7.33e-4 5.910932,0.0016 -4.15e-4,1.969598 0,3.939771 0,5.909369 1.092008,8.31e-4 2.184136,-4.09e-4 3.276559,0 4.15e-4,-1.970007 0,-3.939361 0,-5.909369 1.97001,-4.2e-4 3.93936,4.1e-4 5.90937,0 l 0,-3.2765595 c -1.97001,-4.09e-4 -3.93936,0 -5.90937,0 -8.29e-4,-1.970417 9.38e-4,-3.940913 -0.0016,-5.910931 -1.092008,0.0014 -2.182989,-4.2e-4 -3.274997,0 z M 3.2000323,9.1156305 c 7.85e-4,6.5599345 -0.00134,13.1197455 0.00156,19.6796695 6.5628295,-0.0017 13.1262137,-0.0011 19.6890437,-0.0016 4.15e-4,-2.840958 -4.13e-4,-5.681321 0,-8.521868 -1.092421,-8.3e-4 -2.184136,0 -3.276559,0 -4.15e-4,1.748948 -7.33e-4,3.498332 -0.0016,5.246871 l -13.1249883,0 c -8.29e-4,-4.375497 4.15e-4,-8.751465 0,-13.126551 1.7489552,-8.3e-4 3.4979151,-7.32e-4 5.2468703,-0.0016 -4.15e-4,-1.092008 -4.15e-4,-2.182987 0,-3.2749965 -2.8446958,-8.29e-4 -5.6896729,0 -8.5343672,0 z M 16.556269,14.037501 c -0.07676,0.0062 -0.154516,0.01895 -0.229687,0.04062 -0.503907,0.12525 -0.902584,0.575514 -0.965624,1.090625 -0.0647,0.439209 0.117534,0.902441 0.460937,1.18281 0.237231,0.199071 0.548416,0.306562 0.857812,0.301563 0.391514,4.1e-4 0.773292,-0.197269 1.010936,-0.50625 0.294051,-0.36829 0.356917,-0.900426 0.164062,-1.329685 -0.211205,-0.50225 -0.761122,-0.823201 -1.298436,-0.779687 z m -5.476557,0.321875 c -1.0920077,3.281417 -2.1893355,6.561903 -3.279684,9.84374 3.608229,-0.0048 7.21676,0.0023 10.824989,-0.0047 -0.656947,-1.419239 -1.311483,-2.839702 -1.967185,-4.259371 -0.436306,0.876349 -0.873193,1.752721 -1.314061,2.62656 -1.419237,-2.736447 -2.843577,-5.470614 -4.264059,-8.206241 z" />
        </g>
    </svg>
</vi-resource>

<script src="persistent-object-attribute-image.js"></script>