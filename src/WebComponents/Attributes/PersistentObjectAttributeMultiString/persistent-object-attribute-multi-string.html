<link rel="import" href="../../Popup/popup.html" />
<link rel="import" href="../../Scroller/scroller.html" />
<link rel="import" href="../../Sortable/sortable.html" />
<link rel="import" href="../../Tags/tags.html" />

<dom-module id="vi-persistent-object-attribute-multi-string-item">
    <template>
        <style include="vi-persistent-object-attribute-style-module"></style>
        <link rel="stylesheet" href="persistent-object-attribute-multi-string-item.css" />
        <vi-icon source="Hamburger" class="sort-handle" hidden$="[[sensitive]]"></vi-icon>
        <div class="layout horizontal flex inputhost" sensitive$="[[sensitive]]">
            <input content class="flex" value="{{value::input}}" sensitive$="[[sensitive]]" on-blur="_onInputBlur" type="text" readonly$="[[isReadOnly]]" tabindex$="[[readOnlyTabIndex]]" disabled$="[[disabled]]" placeholder="[[placeholder]]">
        </div>
    </template>
</dom-module>

<dom-module id="vi-persistent-object-attribute-multi-string">
    <template>
        <link rel="stylesheet" href="persistent-object-attribute-multi-string.css" />
        <dom-if if="[[!isTags]]">
            <template>
                <dom-if if="[[!editing]]">
                    <template>
                        <vi-scroller no-horizontal class="flex">
                            <pre sensitive$="[[sensitive]]">[[attribute.displayValue]]</pre>
                        </vi-scroller>
                    </template>
                </dom-if>
                <dom-if if="[[editing]]">
                    <template>
                        <vi-scroller no-horizontal class="flex">
                            <fieldset disabled$="[[attribute.parent.isFrozen]]">
                                <vi-persistent-object-attribute-multi-string-items id="strings" draggable-items="vi-persistent-object-attribute-multi-string-item" handle=".sort-handle" enabled="[[!attribute.parent.isFrozen]]" sensitive$="[[sensitive]]"></vi-persistent-object-attribute-multi-string-items>
                                <vi-persistent-object-attribute-multi-string-item is-new hidden$="[[readOnly]]" placeholder="[[placeholder]]" sensitive$="[[sensitive]]"></vi-persistent-object-attribute-multi-string-item>
                            </fieldset>
                        </vi-scroller>
                    </template>
                </dom-if>
            </template>
        </dom-if>
        <dom-if if="[[isTags]]">
            <template>
                <dom-if if="[[!editing]]">
                    <template>
                        <vi-tags content class="flex" tags="{{tags}}" readonly sensitive="[[sensitive]]"></vi-tags>
                    </template>
                </dom-if>
                <dom-if if="[[editing]]">
                    <template>
                        <vi-persistent-object-attribute-edit attribute="[[attribute]]">
                            <vi-tags content tags="{{tags}}" readonly="[[isTagsReadonly]]" sensitive="[[sensitive]]"></vi-tags>
                            <dom-if if="[[hasSuggestions]]">
                                <template>
                                    <vi-popup id="suggestions" slot="button">
                                        <vi-icon source="Add" slot="header"></vi-icon>
                                        <vi-scroller>
                                            <ul>
                                                <dom-repeat items="[[filteredSuggestions]]" as="suggestion">
                                                    <template>
                                                        <li on-tap="_addSuggestionTag">[[suggestion]]</li>
                                                    </template>
                                                </dom-repeat>
                                            </ul>
                                        </vi-scroller>
                                    </vi-popup>
                                </template>
                            </dom-if>
                        </vi-persistent-object-attribute-edit>
                    </template>
                </dom-if>
            </template>
        </dom-if>
    </template>
</dom-module>

<script src="persistent-object-attribute-multi-string.js"></script>