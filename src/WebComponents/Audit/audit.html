<dom-module id="vi-audit">
    <template>
        <link rel="stylesheet" href="audit.css" />
        <header>
            <span>[[persistentObject.breadcrumb]]</span>
        </header>
        <nav>
            <div class="search layout horizontal center-center">
                <vi-input-search value="{{search}}" on-search="_filter"></vi-input-search>
            </div>
        </nav>
        <vi-scroller class="flex" no-horizontal vertical-scroll-offset="{{verticalScrollOffset}}">
            <main>
                <template is="dom-repeat" items="[[groups]]" as="group">
                    <div class="group">
                        <template is="dom-if" if="[[group.today]]">
                            <a class="today"><h1>[[translations.Today]]</h1></a>
                        </template>
                        <template is="dom-if" if="[[!group.today]]">
                            <a class="date layout horizontal" hidden$="[[group.today]]">
                                <div class="day">[[group.day]]</div>
                                <div>
                                    <div class="dayOfWeek">[[group.dayOfWeek]]</div>
                                    <div class="monthYear">[[group.monthYear]]</div>
                                </div>
                            </a>
                        </template>
                        <template is="dom-repeat" items="[[group.entries]]" as="entry" filter="[[_filterEntry(filter)]]">
                            <a href$="[[entry.href]]" class="entry" on-tap="_open">
                                <div class="time">
                                    <div class="title layout horizontal">
                                        <div class="dot"></div>
                                        <div class="line"></div>
                                        <span>[[entry.time]]</span>
                                    </div>
                                </div>
                                <template is="dom-if" if="[[!entry.busy]]">
                                    <div class="content layout vertical">
                                        <div class="grid">
                                            <vi-icon source="Action_viImpersonate"></vi-icon>
                                            <label class="user">[[entry.user]]&nbsp;[[entry.originalUser]]</label>
                                            <template is="dom-repeat" items="[[entry.changes]]" as="change">
                                                <label class="change">[[change.name]]:</label>
                                                <span>[[change.value]]</span>
                                            </template>
                                        </div>
                                        <template is="dom-if" if="[[entry.outData.notification]]">
                                            <div class="notification" type$="[[entry.outData.notificationType]]">
                                                <span>[[entry.outData.notification]]</span>
                                            </div>
                                        </template>
                                    </div>
                                </template>
                                <div class="busy layout horizontal center-center" hidden$="[[!entry.busy]]">
                                    <vi-spinner block></vi-spinner>
                                </div>
                            </a>
                        </template>
                    </div>
                </template>
            </main>
        </vi-scroller>
    </template>
</dom-module>

<script src="audit.js"></script>