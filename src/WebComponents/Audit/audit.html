<dom-module id="vi-audit">
    <template>
        <link rel="stylesheet" href="audit.css" />
        <header>
            <span>[[persistentObject.breadcrumb]]</span>
        </header>
        <nav>
            <div class="search layout horizontal center-center">
                <vi-input-search value="{{search}}" on-search="_filter"></vi-input-search>
            </div>
        </nav>
        <vi-scroller class="flex" no-horizontal vertical-scroll-offset="{{verticalScrollOffset}}">
            <main>
                <div class="today">[[translations.Today]]</div>
                <template is="dom-repeat" items="[[entries]]" as="entry">
                    <template is="dom-if" if="[[_is(entry, 'Date')]]">
                        <div class="date layout horizontal">
                            <div class="day">[[entry.day]]</div>
                            <div>
                                <div class="dayOfWeek">[[entry.dayOfWeek]]</div>
                                <div class="monthYear">[[entry.monthYear]]</div>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="[[_is(entry, 'LogEntry', filter)]]">
                        <a href$="[[entry.href]]" class="entry" last-of-date$="[[entry.lastOfDate]]" on-tap="_open">
                            <div class="time">
                                <div class="title layout horizontal">
                                    <div class="dot"></div>
                                    <div class="line"></div>
                                    <span>[[entry.time]]</span>
                                </div>
                            </div>
                            <template is="dom-if" if="[[!entry.busy]]">
                                <div class="content layout vertical">
                                    <div class="grid">
                                        <vi-icon source="Action_viImpersonate"></vi-icon>
                                        <label class="user">[[entry.user]]&nbsp;[[entry.originalUser]]</label>
                                        <template is="dom-repeat" items="[[entry.changes]]" as="change">
                                            <label class="change">[[change.name]]:</label>
                                            <span>[[change.value]]</span>
                                        </template>
                                    </div>
                                    <template is="dom-if" if="[[entry.outData.notification]]">
                                        <div class="notification" type$="[[entry.outData.notificationType]]">
                                            <span>[[entry.outData.notification]]</span>
                                        </div>
                                    </template>
                                </div>
                            </template>
                            <div class="busy layout horizontal center-center" hidden$="[[!entry.busy]]">
                                <vi-spinner block></vi-spinner>
                            </div>
                        </a>
                    </template>
                </template>
            </main>
        </vi-scroller>
    </template>
</dom-module>

<script src="audit.js"></script>