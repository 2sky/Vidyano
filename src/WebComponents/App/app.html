<link rel="import" href="../SessionPresenter/session-presenter.html">

<dom-module id="vi-app">
    <template>
        <link rel="stylesheet" href="app.css">
        <vi-profiler service="[[service]]" hidden$="[[!isProfiling]]"></vi-profiler>
        <dom-if if="[[showMenu]]" restamp>
            <template>
                <vi-menu menu label="[[label]]" program-units="[[service.application.programUnits]]" active-program-unit="[[programUnit]]">
                    <slot name="menu-label"></slot>
                </vi-menu>
            </template>
        </dom-if>
        <vi-app-route-presenter class="flex" path="{{pathExtended}}">
            <vi-app-route route=""></vi-app-route>
            <vi-app-route route="Query.:id" component="Vidyano.WebComponents.QueryPresenter"></vi-app-route>
            <vi-app-route route=":programUnitName/Query.:id" component="Vidyano.WebComponents.QueryPresenter"></vi-app-route>
            <vi-app-route route="PersistentObject.:id(/:objectId*)" component="Vidyano.WebComponents.PersistentObjectPresenter"></vi-app-route>
            <vi-app-route route=":programUnitName/PersistentObject.:id(/:objectId*)" component="Vidyano.WebComponents.PersistentObjectPresenter"></vi-app-route>
            <vi-app-route route=":programUnitName/FromAction/:fromActionId" component="Vidyano.WebComponents.PersistentObjectPresenter"></vi-app-route>
            <vi-app-route route=":programUnitName(/)" component="Vidyano.WebComponents.ProgramUnitPresenter"></vi-app-route>
            <vi-app-route class="fit" route="SignIn(/:stateOrReturnUrl*)(/:returnUrl*)" allow-signed-out>
                <template>
                    <vi-sign-in label="[[app.label]]" logo="[[app.signInLogo]]">
                        <slot name="sign-in-background"></slot>
                        <slot name="sign-in-footer"></slot>
                    </vi-sign-in>
                </template>
            </vi-app-route>
            <vi-app-route route="SignOut(/)(:returnUrl*)" allow-signed-out>
                <template>
                    <vi-sign-out></vi-sign-out>
                </template>
            </vi-app-route>
        </vi-app-route-presenter>
        <dom-if if="[[service.application.hasManagement]]">
            <template>
                <vi-popup-menu id="viConfigure" ctrl-key context-menu-only></vi-popup-menu>
            </template>
        </dom-if>
    </template>
</dom-module>

<script src="../AppServiceHooks/app-service-hooks.js"></script>
<script src="../AppCache/app-cache-entry.js"></script>
<script src="../AppCache/app-cache-entry-persistent-object.js"></script>
<script src="../AppCache/app-cache-entry-persistent-object-from-action.js"></script>
<script src="../AppCache/app-cache-entry-query.js"></script>
<script src="app.js"></script>